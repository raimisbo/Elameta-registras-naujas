{% extends "base.html" %}
{% block title %}Nauja užklausa{% endblock %}

{% block content %}
<div class="container">
  <h1 style="margin:16px 0">Nauja užklausa</h1>

  <form method="post" enctype="multipart/form-data" style="display:block">
    {% csrf_token %}

    {% if form.non_field_errors %}
      <div class="flash flash-error">{{ form.non_field_errors }}</div>
    {% endif %}

    <!-- UŽKLAUSA -->
    <section class="box">
      <h3 style="margin:0 0 10px">Užklausa</h3>
      <div class="grid">
        {% for field in form %}
          {% if field.name != "drawing_files" and field.name != "drawing_name" and field.name != "drawing_version" and field.name != "drawing_type" and field.name != "drawing_url" %}
            <label style="display:flex;flex-direction:column;gap:6px">
              <span>{{ field.label }}</span>
              {{ field }}
              {% if field.errors %}<span class="flash flash-error">{{ field.errors|join:", " }}</span>{% endif %}
            </label>
          {% endif %}
        {% endfor %}
      </div>
    </section>

    <!-- BRĖŽINIAI -->
    <section class="box">
      <h3 style="margin:0 0 10px">Brėžiniai</h3>
      <div class="grid">
        <label style="display:flex;flex-direction:column;gap:6px">
          <span>Failai (galima keli)</span>
          <input type="file" name="drawing_files" multiple
         accept="image/*,application/pdf,.dxf,.dwg">
        </label>
        <label style="display:flex;flex-direction:column;gap:6px">
          <span>Pavadinimas</span>
          {{ form.drawing_name }}
        </label>
        <label style="display:flex;flex-direction:column;gap:6px">
          <span>Versija</span>
          {{ form.drawing_version }}
        </label>
        <label style="display:flex;flex-direction:column;gap:6px">
          <span>Tipas (neprivaloma)</span>
          {{ form.drawing_type }}
        </label>
        <label style="display:flex;flex-direction:column;gap:6px">
          <span>Išorinis URL</span>
          {{ form.drawing_url }}
        </label>
      </div>
      <div style="color:#6b7280;font-size:.9em;margin-top:8px">
        Leidžiami: JPG, JPEG, PNG, BMP, WEBP, GIF, SVG, PDF, DXF, DWG.
      </div>
    </section>

    <!-- KAINA -->
    <section class="box">
      <h3 style="margin:0 0 10px">Kaina (pasirinktinai)</h3>
      {% if kaina_form.non_field_errors %}
        <div class="flash flash-error">{{ kaina_form.non_field_errors }}</div>
      {% endif %}
      <div class="grid">
        {% for field in kaina_form %}
          <label style="display:flex;flex-direction:column;gap:6px">
            <span>{{ field.label }}</span>
            {{ field }}
            {% if field.errors %}<span class="flash flash-error">{{ field.errors|join:", " }}</span>{% endif %}
          </label>
        {% endfor %}
      </div>
    </section>

    <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:12px">
      <a class="btn btn-secondary" href="{% url 'detaliu_registras:uzklausa_list' %}">Atgal</a>
      <button class="btn" type="submit">Išsaugoti</button>
    </div>
  </form>
</div>
{% endblock %}
