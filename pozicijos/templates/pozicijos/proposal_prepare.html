{% extends "base.html" %}
{% load static %}

{% block title %}Pasiūlymo paruošimas{% endblock %}

{% block content %}
<h1 style="margin:0 0 10px">Pasiūlymo paruošimas – #{{ pozicija.id }} {{ pozicija.poz_kodas }}</h1>

<form id="prep-form" method="get" action="{% url 'pozicijos:proposal_prepare' pozicija.pk %}" class="box" style="display:grid;gap:10px">
  <div>
    <label><input type="checkbox" name="show_prices" value="1" {% if show_prices %}checked{% endif %}> Rodyti kainų lentelę</label>
  </div>
  <div>
    <label><input type="checkbox" name="show_drawings" value="1" {% if show_drawings %}checked{% endif %}> Rodyti brėžinių sąrašą</label>
  </div>
  <div>
    <label for="notes">Pastabos / sąlygos</label><br>
    <textarea id="notes" name="notes" rows="4" style="width:100%">{{ notes }}</textarea>
  </div>

  <div style="display:flex;gap:8px;flex-wrap:wrap">
    <!-- Atnaujina šį paruošimo puslapį su dabartinėmis varnelėmis -->
    <button type="submit" class="btn btn-secondary">Atnaujinti</button>

    <!-- Šitie du mygtukai siunčia TĄ PAČIĄ formą,
         tik su kitu URL (formaction), todėl visada nuneša varnelės + notes -->
    <button type="submit"
            class="btn btn-secondary"
            formaction="{% url 'pozicijos:pdf' pozicija.pk %}"
            formmethod="get"
            name="preview" value="1">
      Peržiūra (HTML)
    </button>

    <button type="submit"
            class="btn"
            formaction="{% url 'pozicijos:pdf' pozicija.pk %}"
            formmethod="get">
      PDF
    </button>
  </div>
</form>

<div class="box">
  <h3 style="margin:0 0 8px">Kas bus įtraukta į PDF</h3>
  <ul style="margin:0 0 6px 18px">
    <li>Pagrindinė informacija apie poziciją</li>
    <li>Kainų lentelė: <strong>{% if show_prices %}TAIP{% else %}NE{% endif %}</strong></li>
    <li>Brėžinių miniatiūros: <strong>{% if show_drawings %}TAIP{% else %}NE{% endif %}</strong></li>
    <li>Pastabos / sąlygos: <strong>{% if notes %}TAIP{% else %}NE{% endif %}</strong></li>
  </ul>
</div>
{% endblock %}
