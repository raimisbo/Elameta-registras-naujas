{# pozicijos/templates/pozicijos/_tbody.html #}
{% load attr %}

{% for it in items %}
<tr onclick="location.href='{% url 'pozicijos:detail' it.id %}'" style="cursor:pointer;">
  {% for c in columns_schema %}
    {% if c.key in visible_cols %}
      <td data-key="{{ c.key }}">
        {# Specialūs atvaizdavimai pasirinkimams (choices) ir virtualiems laukams #}

        {% if c.key == "maskavimo_tipas" %}
          {{ it.get_maskavimo_tipas_display|default:"—" }}

        {% elif c.key == "pakavimo_tipas" %}
          {{ it.get_pakavimo_tipas_display|default:"—" }}

        {% elif c.key == "atlikimo_terminas" %}
          {% if it.atlikimo_terminas is not None %}
            {{ it.atlikimo_terminas }} d.d.
          {% else %}
            —
          {% endif %}

        {% elif c.key == "matmenys_xyz" %}
          {{ it.matmenys_xyz|default:"—" }}

        {% elif c.key == "kaina_eur" %}
          {# Sąraše rodome rėžį iš aktualių kainų eilučių (kaina_min/kaina_max), jei yra #}
          {% if it.kaina_min is not None and it.kaina_max is not None %}
            {% if it.kaina_min == it.kaina_max %}
              {{ it.kaina_min|floatformat:2 }}
            {% else %}
              {{ it.kaina_min|floatformat:2 }}–{{ it.kaina_max|floatformat:2 }}
            {% endif %}
          {% else %}
            {{ it.kaina_eur|default:"—" }}
          {% endif %}

        {% else %}
          {{ it|attr:c.key|default:"—" }}
        {% endif %}
      </td>
    {% endif %}
  {% endfor %}
</tr>
{% empty %}
<tr>
  <td colspan="{{ visible_cols|length }}">Nėra įrašų.</td>
</tr>
{% endfor %}
